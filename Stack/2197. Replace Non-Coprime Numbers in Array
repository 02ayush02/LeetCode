class Solution {
public:
    int lcm(int x, int y) {
        return x / gcd(x, y) * y;
    }
    vector<int> replaceNonCoprimes(vector<int>& nums) {
        vector<int> ans;
        if (nums.size() == 0) return ans;
        int n = nums.size();

        for (auto it : nums) {
            ans.push_back(it);
            while(ans.size() >= 2) {
                int num1 = ans.back(); ans.pop_back();
                int num2 = ans.back(); ans.pop_back();

                if (gcd(num1, num2) == 1) {
                    ans.push_back(num2);
                    ans.push_back(num1);
                    break;
                } else {
                    ans.push_back(lcm(num1, num2));
                }
            }
        }

        return ans;
    }
};
